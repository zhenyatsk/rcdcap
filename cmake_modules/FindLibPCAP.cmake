IF(WIN32)
	FIND_PATH(LIBPCAP_INCLUDE_DIR NAMES "pcap.h" PATH_SUFFIXES "include" PATHS ${PCAP_DIR})
	FIND_LIBRARY(LIBPCAP_LIBRARY NAMES wpcap PATH_SUFFIXES "lib/x64" PATHS ${PCAP_DIR})
ELSE()
	FIND_PATH(LIBPCAP_INCLUDE_DIR NAMES "pcap.h" PATH_SUFFIXES "include" "local/include")
	IF(PCAP_STATIC)
		SET(PCAP_LIB_NAME libpcap.a)
	ELSE()
		SET(PCAP_LIB_NAME pcap)
	ENDIF()
	FIND_LIBRARY(LIBPCAP_LIBRARY NAMES "${PCAP_LIB_NAME}" PATH_SUFFIXES "lib" "local/lib")

	INCLUDE(FindPackageHandleStandardArgs)
	FIND_PACKAGE_HANDLE_STANDARD_ARGS(LIBPCAP DEFAULT_MSG LIBPCAP_LIBRARY LIBPCAP_INCLUDE_DIR)
ENDIF()

IF(LIBPCAP_INCLUDE_DIR AND LIBPCAP_LIBRARY)
	MARK_AS_ADVANCED(LIBPCAP_INCLUDE_DIR LIBPCAP_LIBRARY)
ENDIF()
